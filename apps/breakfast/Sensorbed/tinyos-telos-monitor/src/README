This is an old version of code. Please use the codes in the *version2 
